# CVE-2017-12635 : Case study and POC

Useful links:

- [https://www.cvedetails.com/cve/CVE-2017-12635/](https://www.cvedetails.com/cve/CVE-2017-12635/)
- [https://www.exploit-db.com/exploits/44498](https://www.exploit-db.com/exploits/44498)
- [https://justi.cz/security/2017/11/14/couchdb-rce-npm.html](https://justi.cz/security/2017/11/14/couchdb-rce-npm.html)

Prerequisites:

- [Docker](https://www.docker.com/)
- [cURL](https://curl.haxx.se/)

## Description

### CouchDB

Apache CouchDB is a document-oriented NoSQL database, implemented in Erlang.

CouchDB uses multiple formats and protocols to store, transfer, and process it's data, it uses JSON to store data, JavaScript as its query language using MapReduce, and HTTP for an API.

CouchDB can be used as a Single Node Database as well as a Cluster.

### Vulnerability

Due to the discrepancy between the Erlang-based JSON parser and JavaScript-based JSON parser, there was a vulnerability in CouchDB before 1.7.0 and 2.x before 2.1.1 allowing non-admin users to escalate privilege by submitting `_users` documents with duplicate `roles` keys used for access control within the databases, including the special case `_admin` role, that denotes administrative users.

To recap, the vulnerability allows non-admin users to give themselves admin privileges.
